CREATE TABLE MVFIN.TB_CLIENTE(
	id NUMBER GENERATED ALWAYS AS IDENTITY,
    nome VARCHAR2(50) NOT NULL,
    telefone VARCHAR2(15) NOT NULL,
    email VARCHAR2(100) NULL,
    tipo_cliente CHAR(1) NOT NULL,
    data_criacao TIMESTAMP NOT NULL,
    PRIMARY KEY(id)
);
 

CREATE TABLE MVFIN.TB_CLIENTE_PF(
	id NUMBER GENERATED ALWAYS AS IDENTITY,
	id_cliente NUMBER NOT NULL,
    cpf VARCHAR2(20) NOT NULL,
    PRIMARY KEY(id),
    CONSTRAINT fk_cliente_pf_cliente FOREIGN KEY (id_cliente) REFERENCES tb_cliente(id)
);

CREATE TABLE MVFIN.TB_CLIENTE_PJ(
	id NUMBER GENERATED ALWAYS AS IDENTITY,
	id_cliente NUMBER NOT NULL,
    razao_social VARCHAR2(100) NOT NULL,
    cnpj VARCHAR2(50) NOT NULL,
    inscricao_estadual VARCHAR2(50) NULL,
    PRIMARY KEY(id),
    CONSTRAINT fk_cliente_pj_cliente FOREIGN KEY (id_cliente) REFERENCES tb_cliente(id)
);

CREATE TABLE MVFIN.TB_ENDERECO(
	id NUMBER GENERATED ALWAYS AS IDENTITY,
	id_cliente NUMBER NOT NULL,
    cep VARCHAR2(8) NOT NULL,
    logradouro VARCHAR2(200) NOT NULL,
    numero VARCHAR2(50) NOT NULL,
    complemento VARCHAR2(100) NULL,
    bairro VARCHAR2(100) NOT NULL,
    cidade VARCHAR2(100) NOT NULL,
    uf VARCHAR2(100) NOT NULL,
    PRIMARY KEY(id),
    CONSTRAINT fk_endereco_cliente FOREIGN KEY (id_cliente) REFERENCES tb_cliente(id)
);


CREATE TABLE MVFIN.TB_CONTA(
	id NUMBER GENERATED ALWAYS AS IDENTITY,
	id_cliente NUMBER NOT NULL,
    agencia VARCHAR2(10) NOT NULL,
    agencia_dig VARCHAR2(3) NOT NULL,
    conta VARCHAR2(10) NOT NULL,
    conta_dig VARCHAR2(3) NOT NULL,
    data_exclusao DATE NULL,
    PRIMARY KEY(id),
    CONSTRAINT fk_conta_cliente FOREIGN KEY (id_cliente) REFERENCES tb_cliente(id)
);

CREATE TABLE MVFIN.TB_USUARIO (
    id_usuario NUMBER GENERATED ALWAYS AS IDENTITY,
    nome VARCHAR2(100) NOT NULL,
    email VARCHAR2(100) NOT NULL,
    usuario VARCHAR2(60) NOT NULL,
    senha VARCHAR2(200) NOT NULL, 
    PRIMARY KEY(id_usuario)
);

CREATE TABLE MVFIN.TB_INSTITUICAO_FINANCEIRA(
	ID NUMBER GENERATED ALWAYS AS IDENTITY,
	BANCO VARCHAR2(50) NOT NULL,
	DESCRICAO VARCHAR2(50) NOT NULL,
	PRIMARY KEY(ID)
);

CREATE TABLE MVFIN.TB_MOVIMENTACAO(
	ID NUMBER GENERATED ALWAYS AS IDENTITY,
	ID_CLIENTE NUMBER NOT NULL,
	ID_CONTA NUMBER NOT NULL,
	ID_INSTITUICAO_FINANCEIRA NUMBER NOT NULL,
	TIPO_MOVIMENTACAO VARCHAR2(50) NOT NULL , -- (CREDITO, DEBITO)
	TIPO_TRANSACAO VARCHAR2(50) NOT NULL, -- (PAGAMENTO, RECEBIMENTOS)
	DATA_MOVIMENTO TIMESTAMP NOT NULL,
	VALOR NUMBER(15,2) NOT NULL,
	PRIMARY KEY(ID),
	CONSTRAINT FK_MOVIMENTACAO_CLIENTE FOREIGN KEY (ID_CLIENTE) REFERENCES TB_CLIENTE(ID),
	CONSTRAINT FK_MOVIMENTACAO_CONTA FOREIGN KEY (ID_CONTA) REFERENCES TB_CONTA(ID),
	CONSTRAINT FK_MOVIMENTACAO_INSTITUICAO_FINANCEIRA FOREIGN KEY (ID_INSTITUICAO_FINANCEIRA) REFERENCES TB_INSTITUICAO_FINANCEIRA(ID),
	CHECK (TIPO_MOVIMENTACAO IN ('CREDITO','DEBITO')),
	CHECK (TIPO_TRANSACAO IN ('PAGAMENTO','RECEBIMENTOS'))
);

